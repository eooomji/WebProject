윈도우 - 검색 - PowerShell 실행 (아무거나 괜찮습니다)

$listener = New-Object System.Net.HttpListener
$listener.Prefixes.Add("http:#127.0.0.1:8000/") # 주소부분
$listener.start()
# 서버 시작 

$data = new-object byte[] 1000 # 데이터 저장 버퍼
$size = 0 # 수신한 데이더 크기

# - 여기까진 처음 1번만

# Http 요청 수신 매 요청마다 실행
$context = $listener.GetContext()

# 수신 내용 확인
$context.request

# 수신한 body $data에 저장, 버퍼의 크기만큼만
$context.request.inputstream.read($data,0,$data.length)
$context.request.inputstream.close()

# $data 내용을 UTF8 문자열로 변환
[system.text.encoding]::utf8.getstring($data)

# 응답 헤더 추가
$context.response.Headers.Add("Access-Control-Allow-Methods", "POST")
$context.response.Headers.Add("Access-Control-Allow-Headers", "content-type")
# 로컬에서 접속 시(주소가 http로 시작하지 않을 경우) null 로 설정
$context.response.Headers.Add("Access-Control-Allow-Origin", "null")

# body 작성. OPTIONS 은 내용 없이 응답
$context.response.outputstream.write([byte[]]0,0,0)
$context.response.outputstream.close()

# $data 내용 전송
$context.response.outputstream.write($data,0,$size)
$context.response.outputstream.close()
