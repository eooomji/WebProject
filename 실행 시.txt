$listener = New-Object System.Net.HttpListener
$listener.Prefixes.Add("http:#127.0.0.1:8000/") # 주소부분
$listener.start()

$data = new-object byte[] 1000
$size = 0

$data = [system.text.encoding]::utf8.getbytes("문자열") # JSON 이 아님
[system.text.encoding]::utf8.getstring($data)
# - 여기까진 처음 1번만

# 아래를 Http 요청 수신마다 실행
$context = $listener.GetContext()
# 요청 내용 확인 시 $context.request 실행

# 여기부터 OPTIONS 요청에 대한 응답 없으면 실행 X
$context = $listener.GetContext()

$context.response.Headers.Add("Access-Control-Allow-Methods", "POST")
$context.response.Headers.Add("Access-Control-Allow-Headers", "content-type")
$context.response.Headers.Add("Access-Control-Allow-Origin", "null")

# body 내용 없이 응답
$context.response.outputstream.write([byte[]]0,0,0)
$context.response.outputstream.close()
# 여기까지 OPTIONS 요청에 대한 응답 없으면 실행 X

$context.response.Headers.Add("Access-Control-Allow-Methods", "POST")
$context.response.Headers.Add("Access-Control-Allow-Headers", "content-type")
$context.response.Headers.Add("Access-Control-Allow-Origin", "null")

$context.response.outputstream.write($data,0,$size)
$context.response.outputstream.close()
